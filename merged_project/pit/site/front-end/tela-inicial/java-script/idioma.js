// ========== DICIONÃRIO DE TRADUÃ‡Ã•ES ==========
const translations = {
    pt: {
        page_title: "NutriBot - Assistente de Dieta",
        app_name: "NutriBot",
        welcome_title: "Bem-vindo ao NutriBot",
        about_title: "Sobre o Aplicativo",
        about_description: "Seu assistente pessoal de nutriÃ§Ã£o com suporte a mÃºltiplos idiomas. Receba planos alimentares personalizados, calcule seu IMC e obtenha dicas de saÃºde.",
        stat_recipes: "Receitas",
        stat_users: "UsuÃ¡rios",
        stat_languages: "Idiomas",
        stat_rating: "AvaliaÃ§Ã£o",
        quick_actions: "AÃ§Ãµes RÃ¡pidas",
        btn_create_diet: "Criar Plano Alimentar",
        btn_calculate_imc: "Calcular IMC",
        btn_tips: "Ver Dicas de SaÃºde",
        language_info_title: "Suporte Multi-idiomas",
        available_languages: "Idiomas DisponÃ­veis",
        languages_description: "O aplicativo estÃ¡ disponÃ­vel em 5 idiomas: PortuguÃªs, InglÃªs, Espanhol, FrancÃªs e AlemÃ£o. Selecione seu idioma preferido no menu superior.",
        nav_home: "InÃ­cio",
        nav_foods: "Alimentos",
        nav_tips: "Dicas",
        nav_chat: "Chat",
        nav_profile: "Perfil",
        feature_coming_soon: "Funcionalidade em breve!",
        language_changed: "Idioma alterado com sucesso!"
    },
    en: {
        page_title: "NutriBot - Diet Assistant",
        app_name: "NutriBot",
        welcome_title: "Welcome to NutriBot",
        about_title: "About the App",
        about_description: "Your personal nutrition assistant with multi-language support. Get personalized meal plans, calculate your BMI and receive health tips.",
        stat_recipes: "Recipes",
        stat_users: "Users",
        stat_languages: "Languages",
        stat_rating: "Rating",
        quick_actions: "Quick Actions",
        btn_create_diet: "Create Meal Plan",
        btn_calculate_imc: "Calculate BMI",
        btn_tips: "View Health Tips",
        language_info_title: "Multi-language Support",
        available_languages: "Available Languages",
        languages_description: "The app is available in 5 languages: Portuguese, English, Spanish, French and German. Select your preferred language from the menu above.",
        nav_home: "Home",
        nav_foods: "Foods",
        nav_tips: "Tips",
        nav_chat: "Chat",
        nav_profile: "Profile",
        feature_coming_soon: "Feature coming soon!",
        language_changed: "Language changed successfully!"
    },
    es: {
        page_title: "NutriBot - Asistente de Dieta",
        app_name: "NutriBot",
        welcome_title: "Bienvenido a NutriBot",
        about_title: "Sobre la AplicaciÃ³n",
        about_description: "Tu asistente personal de nutriciÃ³n con soporte multiidioma. Recibe planes alimentarios personalizados, calcula tu IMC y obtÃ©n consejos de salud.",
        stat_recipes: "Recetas",
        stat_users: "Usuarios",
        stat_languages: "Idiomas",
        stat_rating: "CalificaciÃ³n",
        quick_actions: "Acciones RÃ¡pidas",
        btn_create_diet: "Crear Plan Alimentario",
        btn_calculate_imc: "Calcular IMC",
        btn_tips: "Ver Consejos de Salud",
        language_info_title: "Soporte Multi-idioma",
        available_languages: "Idiomas Disponibles",
        languages_description: "La aplicaciÃ³n estÃ¡ disponible en 5 idiomas: PortuguÃ©s, InglÃ©s, EspaÃ±ol, FrancÃ©s y AlemÃ¡n. Selecciona tu idioma preferido en el menÃº superior.",
        nav_home: "Inicio",
        nav_foods: "Alimentos",
        nav_tips: "Consejos",
        nav_chat: "Chat",
        nav_profile: "Perfil",
        feature_coming_soon: "Â¡FunciÃ³n prÃ³ximamente!",
        language_changed: "Â¡Idioma cambiado con Ã©xito!"
    },
    fr: {
        page_title: "NutriBot - Assistant DiÃ©tÃ©tique",
        app_name: "NutriBot",
        welcome_title: "Bienvenue sur NutriBot",
        about_title: "Ã€ propos de l'Application",
        about_description: "Votre assistant personnel de nutrition avec support multilingue. Obtenez des plans de repas personnalisÃ©s, calculez votre IMC et recevez des conseils santÃ©.",
        stat_recipes: "Recettes",
        stat_users: "Utilisateurs",
        stat_languages: "Langues",
        stat_rating: "Note",
        quick_actions: "Actions Rapides",
        btn_create_diet: "CrÃ©er un Plan Alimentaire",
        btn_calculate_imc: "Calculer l'IMC",
        btn_tips: "Voir les Conseils SantÃ©",
        language_info_title: "Support Multi-langues",
        available_languages: "Langues Disponibles",
        languages_description: "L'application est disponible en 5 langues: Portugais, Anglais, Espagnol, FranÃ§ais et Allemand. SÃ©lectionnez votre langue prÃ©fÃ©rÃ©e dans le menu ci-dessus.",
        nav_home: "Accueil",
        nav_foods: "Aliments",
        nav_tips: "Conseils",
        nav_chat: "Chat",
        nav_profile: "Profil",
        feature_coming_soon: "FonctionnalitÃ© bientÃ´t disponible!",
        language_changed: "Langue changÃ©e avec succÃ¨s!"
    },
    de: {
        page_title: "NutriBot - DiÃ¤t-Assistent",
        app_name: "NutriBot",
        welcome_title: "Willkommen bei NutriBot",
        about_title: "Ãœber die App",
        about_description: "Ihr persÃ¶nlicher ErnÃ¤hrungsassistent mit mehrsprachiger UnterstÃ¼tzung. Erhalten Sie personalisierte EssensplÃ¤ne, berechnen Sie Ihren BMI und erhalten Sie Gesundheitstipps.",
        stat_recipes: "Rezepte",
        stat_users: "Benutzer",
        stat_languages: "Sprachen",
        stat_rating: "Bewertung",
        quick_actions: "Schnellaktionen",
        btn_create_diet: "Essensplan Erstellen",
        btn_calculate_imc: "BMI Berechnen",
        btn_tips: "Gesundheitstipps Ansehen",
        language_info_title: "Mehrsprachige UnterstÃ¼tzung",
        available_languages: "VerfÃ¼gbare Sprachen",
        languages_description: "Die App ist in 5 Sprachen verfÃ¼gbar: Portugiesisch, Englisch, Spanisch, FranzÃ¶sisch und Deutsch. WÃ¤hlen Sie Ihre bevorzugte Sprache im MenÃ¼ oben.",
        nav_home: "Startseite",
        nav_foods: "Lebensmittel",
        nav_tips: "Tipps",
        nav_chat: "Chat",
        nav_profile: "Profil",
        feature_coming_soon: "Funktion kommt bald!",
        language_changed: "Sprache erfolgreich geÃ¤ndert!"
    }
};

// ========== INFORMAÃ‡Ã•ES DOS IDIOMAS ==========
const languageNames = {
    pt: { name: "PortuguÃªs", flag: "ðŸ‡§ðŸ‡·" },
    en: { name: "English", flag: "ðŸ‡ºðŸ‡¸" },
    es: { name: "EspaÃ±ol", flag: "ðŸ‡ªðŸ‡¸" },
    fr: { name: "FranÃ§ais", flag: "ðŸ‡«ðŸ‡·" },
    de: { name: "Deutsch", flag: "ðŸ‡©ðŸ‡ª" }
};

// ========== VARIÃVEL GLOBAL DO IDIOMA ATUAL ==========
let currentLanguage = localStorage.getItem('language') || 'pt';

// ========== INICIALIZAÃ‡ÃƒO ==========
window.addEventListener('DOMContentLoaded', () => {
    applyLanguage(currentLanguage);
});

// ========== FUNÃ‡ÃƒO PARA ALTERNAR DROPDOWN ==========
function toggleLanguageDropdown() {
    const dropdown = document.getElementById('languageDropdown');
    dropdown.classList.toggle('active');
}

// ========== FUNÃ‡ÃƒO PARA MUDAR IDIOMA ==========
function changeLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    applyLanguage(lang);
    toggleLanguageDropdown();
    showNotification('language_changed');
}

// ========== FUNÃ‡ÃƒO PARA APLICAR IDIOMA ==========
function applyLanguage(lang) {
    const langData = translations[lang];
    
    // Atualizar todos os elementos com data-i18n
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (langData[key]) {
            element.textContent = langData[key];
        }
    });

    // Atualizar tÃ­tulo da pÃ¡gina
    document.title = langData.page_title;

    // Atualizar seletor de idioma
    const langInfo = languageNames[lang];
    document.getElementById('currentFlag').textContent = langInfo.flag;
    document.getElementById('currentLang').textContent = langInfo.name;

    // Atualizar atributo lang do HTML
    document.documentElement.lang = lang;

    // Atualizar opÃ§Ãµes ativas no dropdown
    document.querySelectorAll('.language-option').forEach(option => {
        option.classList.remove('active');
        if (option.getAttribute('data-lang') === lang) {
            option.classList.add('active');
        }
    });
}

// ========== FUNÃ‡ÃƒO PARA MOSTRAR NOTIFICAÃ‡ÃƒO ==========
function showNotification(messageKey) {
    const notification = document.getElementById('notification');
    const message = translations[currentLanguage][messageKey];
    notification.textContent = message;
    notification.classList.add('show');

    setTimeout(() => {
        notification.classList.remove('show');
    }, 3000);
}

// ========== FECHAR DROPDOWN AO CLICAR FORA ==========
document.addEventListener('click', function(event) {
    const selector = document.querySelector('.language-selector');
    if (!selector.contains(event.target)) {
        document.getElementById('languageDropdown').classList.remove('active');
    }
});

// ========== FUNÃ‡ÃƒO AUXILIAR PARA OBTER TRADUÃ‡ÃƒO ==========
// Use esta funÃ§Ã£o em outras partes do cÃ³digo para obter traduÃ§Ãµes
function getTranslation(key) {
    return translations[currentLanguage][key] || key;
}

// ========== EXPORTAR PARA USO EM OUTROS SCRIPTS ==========
// Se vocÃª precisar usar o sistema de idiomas em outros arquivos JS:
window.i18n = {
    currentLanguage: () => currentLanguage,
    translate: getTranslation,
    changeLanguage: changeLanguage,
    translations: translations
};